<div class="issue_detail"
     ng-controller="IssueCtrl as issueCtrl"
     ng-init="issueCtrl.init(issue)"
	  ng-class="{pull: issueCtrl.isPullRequest()}">

  <div class="header">
    <span class="user-selector dropdown">
      <a class="dropdown-toggle">
        <img class="avatar"
            ng-class="{
                empty: !issueCtrl.issue.assignee
             }"
             title="Assigned to {{issueCtrl.getAssignedUserDetails(30).name}}"
             ng-src="{{issueCtrl.getAssignedUserDetails(30).avatar_url}}"/>
      </a>
      <ul class="dropdown-menu">
        <li ng-repeat="user in repoModel.assignees"
            class="assignee"
            ng-click="issueCtrl.assignUser(user)">
          <img class="avatar" ng-src="{{user.avatar_url}}?s=30"></img>
          <span class="user_login">{{user.login}}</span>
        </li>
      </ul>
    </span>

    <span class="title">
      {{issueCtrl.issue.title}}
    </span>
    <a target="_blank" href="{{issueCtrl.issue.html_url}}" title="Open on GitHub" class="number">
	 	<i ng-if="issueCtrl.isPullRequest()" class="icon-code-fork"></i>
		{{issueCtrl.issue.number}}
	 </a>
    <i class="close icon-remove" ng-click="$close()"></i>
  </div>

  <div class="status_header">
    <div ng-if="issueCtrl.isPullRequest()"
         class="build_status"
         ng-class="issueCtrl.getBuildStatus()">
      <a href="{{issueCtrl.tr_top_build_status.target_url}}" target="_blank">
      {{issueCtrl.tr_top_build_status.description}}
      </a>
    </div>
	 <div class="comment_summary">
		<!--<span class="todos"><i class="icon-check"></i>3/6</span>-->
		<span class="comment_number">
    		<i class="icon-comments"></i>
    		{{issueCtrl.tr_comments.length}}
		</span>
		<span class="vote_count"
			ng-class="{
           positive: issueCtrl.issue.tr_comment_voting.total > 0,
           negative: issueCtrl.issue.tr_comment_voting.total < 0
          }">
			{{issueCtrl.issue.tr_comment_voting.total}}
		</span>
    </div>
  </div>

  	<div class="branch_info" ng-show="issueCtrl.isPullRequest()">
     to <pre>{{issueCtrl.issue.tr_pull_details.base.label}}</pre>
     from <pre>{{issueCtrl.issue.tr_pull_details.tr_head.label}}</pre>
   </div>

  <div class="controls">
      <select class="milestone" 
              ng-init="msValue=issueCtrl.issue.milestone.number"
              ng-model="msValue"
              ng-options="m.number as m.title for m in repoModel.milestones"
              ng-change="issueCtrl.assignMilestone(msValue)">
        <option value="">No Milestone</option>
      </select>
    	<div class="label_bar">
		    <span class="label"
		      ng-repeat="label in issueCtrl.issue.labels | nonColumnLabels"
		      style="background-color: #{{label.color}}">
		      {{label.name}}
		    </span>
		  </div>

		  <div class="label_editor dropdown">
		    <button class="btn dropdown-toggle-no-close">Edit<span class="caret"/></button>

		    <div class="dropdown-menu">
		      <div class="label-list no-close">
		         <div class="label-item"
		              ng-repeat="label in repoModel.labels | nonColumnLabels"
		              ng-click="issueCtrl.toggleLabel(label)"
		              ng-class="{
		                enabled: issueCtrl.isLabelEnabled(label.name)
		              }">
		              <span class="pill" style="background-color: #{{label.color}}">
		                 {{label.name}}
		              </span>
		          </div>
		      </div>
		    </div>
		  </div>
	<button ng-if="!issueCtrl.isPullRequest()"
	        class="convert_pull btn btn-success"
	        ng-click="issueCtrl.convertToPull()">
	    Convert to Pull
	    </button>
  </div>

  <div class="scroll_area">
    <div class="description">
	   <h4>Description:</h4>
      {{issueCtrl.issue.body}}
    </div>

    <div class="comments">
        <div class="comment"
            ng-repeat="comment in issueCtrl.issue.tr_comments">
          <img class="commenter"
               ng-src="{{comment.user.avatar_url}}?s=30"/>
			 <h4><em>{{comment.user.login}}</em> commented:</h4>
          <div class="comment_body" ng-bind-html="comment.body_html"/>
        </div>
    </div>
  </div>

</div>
